{"version":3,"file":"create-project-Ca1Sy1_F.js","names":["context: ServerContext","clientKey: ClientKey | null"],"sources":["../src/tools/create-project.ts"],"sourcesContent":["import { z } from \"zod\";\nimport { setTag } from \"@sentry/core\";\nimport { defineTool } from \"./utils/defineTool\";\nimport { apiServiceFromContext } from \"./utils/api-utils\";\nimport { logError } from \"../logging\";\nimport type { ServerContext } from \"../types\";\nimport type { ClientKey } from \"../api-client/index\";\nimport {\n  ParamOrganizationSlug,\n  ParamRegionUrl,\n  ParamTeamSlug,\n  ParamPlatform,\n} from \"../schema\";\n\nexport default defineTool({\n  name: \"create_project\",\n  description: [\n    \"Create a new project in Sentry (includes DSN automatically).\",\n    \"\",\n    \"üîç USE THIS TOOL WHEN USERS WANT TO:\",\n    \"- 'Create a new project'\",\n    \"- 'Set up a project for [app/service] with team [X]'\",\n    \"- 'I need a new Sentry project'\",\n    \"- Create project AND need DSN in one step\",\n    \"\",\n    \"‚ùå DO NOT USE create_dsn after this - DSN is included in output.\",\n    \"\",\n    \"Be careful when using this tool!\",\n    \"\",\n    \"<examples>\",\n    \"### Create new project with team\",\n    \"```\",\n    \"create_project(organizationSlug='my-organization', teamSlug='my-team', name='my-project', platform='javascript')\",\n    \"```\",\n    \"</examples>\",\n    \"\",\n    \"<hints>\",\n    \"- If the user passes a parameter in the form of name/otherName, its likely in the format of <organizationSlug>/<teamSlug>.\",\n    \"- If any parameter is ambiguous, you should clarify with the user what they meant.\",\n    \"</hints>\",\n  ].join(\"\\n\"),\n  inputSchema: {\n    organizationSlug: ParamOrganizationSlug,\n    regionUrl: ParamRegionUrl.optional(),\n    teamSlug: ParamTeamSlug,\n    name: z\n      .string()\n      .trim()\n      .describe(\n        \"The name of the project to create. Typically this is commonly the name of the repository or service. It is only used as a visual label in Sentry.\",\n      ),\n    platform: ParamPlatform.optional(),\n  },\n  async handler(params, context: ServerContext) {\n    const apiService = apiServiceFromContext(context, {\n      regionUrl: params.regionUrl,\n    });\n    const organizationSlug = params.organizationSlug;\n\n    setTag(\"organization.slug\", organizationSlug);\n    setTag(\"team.slug\", params.teamSlug);\n\n    const project = await apiService.createProject({\n      organizationSlug,\n      teamSlug: params.teamSlug,\n      name: params.name,\n      platform: params.platform,\n    });\n    let clientKey: ClientKey | null = null;\n    try {\n      clientKey = await apiService.createClientKey({\n        organizationSlug,\n        projectSlug: project.slug,\n        name: \"Default\",\n      });\n    } catch (err) {\n      logError(err);\n    }\n    let output = `# New Project in **${organizationSlug}**\\n\\n`;\n    output += `**ID**: ${project.id}\\n`;\n    output += `**Slug**: ${project.slug}\\n`;\n    output += `**Name**: ${project.name}\\n`;\n    if (clientKey) {\n      output += `**SENTRY_DSN**: ${clientKey?.dsn.public}\\n\\n`;\n    } else {\n      output += \"**SENTRY_DSN**: There was an error fetching this value.\\n\\n\";\n    }\n    output += \"# Using this information\\n\\n\";\n    output += `- You can reference the **SENTRY_DSN** value to initialize Sentry's SDKs.\\n`;\n    output += `- You should always inform the user of the **SENTRY_DSN** and Project Slug values.\\n`;\n    return output;\n  },\n});\n"],"mappings":";;;;;;;;AAcA,6BAAe,WAAW;CACxB,MAAM;CACN,aAAa;EACX;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;CACD,EAAC,KAAK,KAAK;CACZ,aAAa;EACX,kBAAkB;EAClB,WAAW,eAAe,UAAU;EACpC,UAAU;EACV,MAAM,EACH,QAAQ,CACR,MAAM,CACN,SACC,oJACD;EACH,UAAU,cAAc,UAAU;CACnC;CACD,MAAM,QAAQ,QAAQA,SAAwB;EAC5C,MAAM,aAAa,sBAAsB,SAAS,EAChD,WAAW,OAAO,UACnB,EAAC;EACF,MAAM,mBAAmB,OAAO;AAEhC,SAAO,qBAAqB,iBAAiB;AAC7C,SAAO,aAAa,OAAO,SAAS;EAEpC,MAAM,UAAU,MAAM,WAAW,cAAc;GAC7C;GACA,UAAU,OAAO;GACjB,MAAM,OAAO;GACb,UAAU,OAAO;EAClB,EAAC;EACF,IAAIC,YAA8B;AAClC,MAAI;AACF,eAAY,MAAM,WAAW,gBAAgB;IAC3C;IACA,aAAa,QAAQ;IACrB,MAAM;GACP,EAAC;EACH,SAAQ,KAAK;AACZ,YAAS,IAAI;EACd;EACD,IAAI,UAAU,qBAAqB,iBAAiB;AACpD,aAAW,UAAU,QAAQ,GAAG;AAChC,aAAW,YAAY,QAAQ,KAAK;AACpC,aAAW,YAAY,QAAQ,KAAK;AACpC,MAAI,UACF,YAAW,kBAAkB,WAAW,IAAI,OAAO;MAEnD,WAAU;AAEZ,YAAU;AACV,aAAW;AACX,aAAW;AACX,SAAO;CACR;AACF,EAAC"}