{"version":3,"file":"find-organizations-BDtHkcFV.cjs","names":["context: ServerContext"],"sources":["../src/tools/find-organizations.ts"],"sourcesContent":["import { z } from \"zod\";\nimport { defineTool } from \"./utils/defineTool\";\nimport { apiServiceFromContext, withApiErrorHandling } from \"./utils/api-utils\";\nimport type { ServerContext } from \"../types\";\n\nexport default defineTool({\n  name: \"find_organizations\",\n  description: [\n    \"Find organizations that the user has access to in Sentry.\",\n    \"\",\n    \"Use this tool when you need to:\",\n    \"- View all organizations in Sentry\",\n    \"- Find an organization's slug to aid other tool requests\",\n  ].join(\"\\n\"),\n  inputSchema: {},\n  async handler(params, context: ServerContext) {\n    // User data endpoints (like /users/me/regions/) should never use regionUrl\n    // as they must always query the main API server, not region-specific servers\n    const apiService = apiServiceFromContext(context);\n    const organizations = await withApiErrorHandling(\n      () => apiService.listOrganizations(),\n      {}, // No params for this endpoint\n    );\n\n    let output = \"# Organizations\\n\\n\";\n\n    if (organizations.length === 0) {\n      output += \"You don't appear to be a member of any organizations.\\n\";\n      return output;\n    }\n\n    output += organizations\n      .map((org) =>\n        [\n          `## **${org.slug}**`,\n          \"\",\n          `**Web URL:** ${org.links?.organizationUrl || \"Not available\"}`,\n          `**Region URL:** ${org.links?.regionUrl || \"\"}`,\n        ].join(\"\\n\"),\n      )\n      .join(\"\\n\\n\");\n\n    output += \"\\n\\n# Using this information\\n\\n\";\n    output += `- The organization's name is the identifier for the organization, and is used in many tools for \\`organizationSlug\\`.\\n`;\n\n    const hasValidRegionUrls = organizations.some((org) =>\n      org.links?.regionUrl?.trim(),\n    );\n\n    if (hasValidRegionUrls) {\n      output += `- If a tool supports passing in the \\`regionUrl\\`, you MUST pass in the correct value shown above for each organization.\\n`;\n      output += `- For Sentry's Cloud Service (sentry.io), always use the regionUrl to ensure requests go to the correct region.\\n`;\n    } else {\n      output += `- This appears to be a self-hosted Sentry installation. You can omit the \\`regionUrl\\` parameter when using other tools.\\n`;\n      output += `- For self-hosted Sentry, the regionUrl is typically empty and not needed for API calls.\\n`;\n    }\n\n    return output;\n  },\n});\n"],"mappings":";;;;AAKA,iCAAe,8BAAW;CACxB,MAAM;CACN,aAAa;EACX;EACA;EACA;EACA;EACA;CACD,EAAC,KAAK,KAAK;CACZ,aAAa,CAAE;CACf,MAAM,QAAQ,QAAQA,SAAwB;EAG5C,MAAM,aAAa,wCAAsB,QAAQ;EACjD,MAAM,gBAAgB,MAAM,uCAC1B,MAAM,WAAW,mBAAmB,EACpC,CAAE,EACH;EAED,IAAI,SAAS;AAEb,MAAI,cAAc,WAAW,GAAG;AAC9B,aAAU;AACV,UAAO;EACR;AAED,YAAU,cACP,IAAI,CAAC,QACJ;IACG,OAAO,IAAI,KAAK;GACjB;IACC,eAAe,IAAI,OAAO,mBAAmB;IAC7C,kBAAkB,IAAI,OAAO,aAAa;EAC5C,EAAC,KAAK,KAAK,CACb,CACA,KAAK,OAAO;AAEf,YAAU;AACV,aAAW;EAEX,MAAM,qBAAqB,cAAc,KAAK,CAAC,QAC7C,IAAI,OAAO,WAAW,MAAM,CAC7B;AAED,MAAI,oBAAoB;AACtB,cAAW;AACX,cAAW;EACZ,OAAM;AACL,cAAW;AACX,cAAW;EACZ;AAED,SAAO;CACR;AACF,EAAC"}